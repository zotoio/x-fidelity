---
generated: 2026-02-01 12:18
sourceChecksum: "3515113843"
beforeTokens: 2224
afterTokens: 377
confidence: 94%
crux: true
alwaysApply: false
---

> [!IMPORTANT]
> Generated file - do not edit!

# X-Fidelity VS Code Extension Architecture

```crux
⟦CRUX:vscode-optimise.md
Ρ{xfi-vscode;in-process;¬CLI}

Π{
  ExtMgr+AnalysisMgr→cfg+rules→plugins→XFI_RESULT{repoCfg,ScanResult[]}
  treesitter:native→fallback:WASM;Parser.init()»Language.load(js|ts.wasm)
  node{startPos,endPos}→RuleFailure.details∋{line,col,endLine,endCol}
  vscode.Range(ln-1,col,endLn-1,endCol)→Diagnostic→diagnosticCollection
  bundle:esbuild→dist/extension.js;copy *.wasm→dist/
}

P{
  ¬registerFallbackCommands!;¬handleInitializationError!;¬shouldUseFallbackMode!
  ¬xfidelity.fallback.*@package.json!;¬fallback tests!
}

Λ{
  1:+web-tree-sitter@deps;activate→initWasm(ctx);singleton;cache parser
  2:@xfi-plugins:violation→node.pos{row,col}→IssueDetail∋{start,end}{Ln,Col}
  3:@xfi-types/core.ts:+{startLine,startCol,endLine,endCol}:num;rebuild
  4:@diagnosticProvider:read range→vscode.Range→Diagnostic→set(uri,diags)
  5:rm fallback@extension.ts+package.json;upd tests
  6:esbuild:copy wasm→dist;verify path;test vsce package
}

Ω{unit:AST→range fields;integ:fixtures/node-fullstack;¬fallback;lint}
⟧
```
