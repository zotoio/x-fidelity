"use strict";(self.webpackChunkx_fidelity_website=self.webpackChunkx_fidelity_website||[]).push([[5546],{1876:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"docker-deployment","title":"Docker Deployment","description":"This guide explains how to deploy x-fidelity\'s config server using Docker.","source":"@site/docs/docker-deployment.md","sourceDirName":".","slug":"/docker-deployment","permalink":"/x-fidelity/docs/docker-deployment","draft":false,"unlisted":false,"editUrl":"https://github.com/zotoio/x-fidelity/edit/main/website/docs/docker-deployment.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12},"sidebar":"docs","previous":{"title":"Config Server","permalink":"/x-fidelity/docs/config-server"},"next":{"title":"GitHub Webhooks","permalink":"/x-fidelity/docs/github-webhooks"}}');var r=i(4848),l=i(8453);const o={sidebar_position:12},c="Docker Deployment",t={},d=[{value:"Quick Start",id:"quick-start",level:2},{value:"Building and Running",id:"building-and-running",level:2},{value:"Using Docker Compose",id:"using-docker-compose",level:3},{value:"Using Docker Directly",id:"using-docker-directly",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Volumes",id:"volumes",level:3},{value:"SSL/TLS",id:"ssltls",level:3},{value:"Health Checks",id:"health-checks",level:2},{value:"Production Deployment",id:"production-deployment",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"docker-deployment",children:"Docker Deployment"})}),"\n",(0,r.jsx)(n.p,{children:"This guide explains how to deploy x-fidelity's config server using Docker."}),"\n",(0,r.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Create a ",(0,r.jsx)(n.code,{children:"Dockerfile"}),":"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dockerfile",children:'FROM node:18-alpine\n\n# Install required packages\nRUN apk add --no-cache openssl\n\n# Set working directory\nWORKDIR /usr/src/app\n\n# Generate self-signed certificate for HTTPS\nRUN mkdir certs && \\\n    openssl req -x509 -newkey rsa:4096 -keyout certs/tls.key -out certs/tls.pem -days 365 -nodes \\\n    -subj "/C=US/ST=State/L=City/O=Organization/CN=localhost"\n\n# Install x-fidelity\nRUN yarn global add x-fidelity && \\\n    export PATH="$PATH:$(yarn global bin)"\n\n# Create config directory\nRUN mkdir config\n\n# Set environment variables\nENV NODE_ENV=production\nENV XFI_LISTEN_PORT=8888\nENV CERT_PATH=/usr/src/app/certs\n\n# Expose port\nEXPOSE 8888\n\n# Start config server\nCMD ["xfidelity", "--mode", "server", "--port", "8888", "--localConfigPath", "/usr/src/app/config"]\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["Create a ",(0,r.jsx)(n.code,{children:"docker-compose.yml"}),":"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"services:\n  x-fidelity-server:\n    build: .\n    ports:\n      - 8888:8888\n    volumes:\n      - ./config:/usr/src/app/config\n    environment:\n      - NODE_ENV=production\n      - XFI_LISTEN_PORT=8888\n      - CERT_PATH=/usr/src/app/certs\n      - XFI_SHARED_SECRET=your_secret_here\n"})}),"\n",(0,r.jsx)(n.h2,{id:"building-and-running",children:"Building and Running"}),"\n",(0,r.jsx)(n.h3,{id:"using-docker-compose",children:"Using Docker Compose"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Build and start the server\ndocker-compose up --build\n\n# Run in detached mode\ndocker-compose up -d\n\n# Stop the server\ndocker-compose down\n"})}),"\n",(0,r.jsx)(n.h3,{id:"using-docker-directly",children:"Using Docker Directly"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Build the image\ndocker build -t x-fidelity .\n\n# Run the container\ndocker run -p 8888:8888 \\\n  -v $(pwd)/config:/usr/src/app/config \\\n  -e XFI_SHARED_SECRET=your_secret_here \\\n  x-fidelity\n"})}),"\n",(0,r.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.h3,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"NODE_ENV"}),": Set to 'production' for production deployments"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"XFI_LISTEN_PORT"}),": Server port (default: 8888)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"CERT_PATH"}),": Path to SSL certificates"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"XFI_SHARED_SECRET"}),": Shared secret for authentication"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GITHUB_WEBHOOK_SECRET"}),": Secret for GitHub webhooks"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"volumes",children:"Volumes"}),"\n",(0,r.jsx)(n.p,{children:"Mount your configuration directory:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"volumes:\n  - ./config:/usr/src/app/config\n"})}),"\n",(0,r.jsx)(n.h3,{id:"ssltls",children:"SSL/TLS"}),"\n",(0,r.jsx)(n.p,{children:"The Dockerfile generates self-signed certificates. For production:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Mount your own certificates:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"volumes:\n  - ./certs:/usr/src/app/certs\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Update environment variables:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"environment:\n  - CERT_PATH=/usr/src/app/certs\n"})}),"\n",(0,r.jsx)(n.h2,{id:"health-checks",children:"Health Checks"}),"\n",(0,r.jsx)(n.p,{children:"Add health checks to your Docker Compose configuration:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'services:\n  x-fidelity-server:\n    # ... other configuration ...\n    healthcheck:\n      test: ["CMD", "curl", "-f", "https://localhost:8888/health"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 40s\n'})}),"\n",(0,r.jsx)(n.h2,{id:"production-deployment",children:"Production Deployment"}),"\n",(0,r.jsx)(n.p,{children:"For production deployments:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Use proper SSL certificates"}),"\n",(0,r.jsx)(n.li,{children:"Set strong secrets"}),"\n",(0,r.jsx)(n.li,{children:"Configure proper logging"}),"\n",(0,r.jsx)(n.li,{children:"Set up monitoring"}),"\n",(0,r.jsx)(n.li,{children:"Use container orchestration"}),"\n",(0,r.jsx)(n.li,{children:"Implement backups"}),"\n",(0,r.jsx)(n.li,{children:"Set resource limits"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Example production ",(0,r.jsx)(n.code,{children:"docker-compose.yml"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'services:\n  x-fidelity-server:\n    build: .\n    ports:\n      - 8888:8888\n    volumes:\n      - ./config:/usr/src/app/config\n      - ./certs:/usr/src/app/certs\n      - ./logs:/usr/src/app/logs\n    environment:\n      - NODE_ENV=production\n      - XFI_LISTEN_PORT=8888\n      - CERT_PATH=/usr/src/app/certs\n      - XFI_SHARED_SECRET=${XFI_SHARED_SECRET}\n      - GITHUB_WEBHOOK_SECRET=${GITHUB_WEBHOOK_SECRET}\n    healthcheck:\n      test: ["CMD", "curl", "-f", "https://localhost:8888/health"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n    deploy:\n      resources:\n        limits:\n          cpus: \'1\'\n          memory: 1G\n        reservations:\n          cpus: \'0.5\'\n          memory: 512M\n      restart_policy:\n        condition: on-failure\n        delay: 5s\n        max_attempts: 3\n        window: 120s\n    logging:\n      driver: "json-file"\n      options:\n        max-size: "10m"\n        max-file: "3"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Certificate Issues"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check certificate paths"}),"\n",(0,r.jsx)(n.li,{children:"Verify certificate permissions"}),"\n",(0,r.jsxs)(n.li,{children:["For testing, set ",(0,r.jsx)(n.code,{children:"NODE_TLS_REJECT_UNAUTHORIZED=0"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Connection Issues"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Verify port mappings"}),"\n",(0,r.jsx)(n.li,{children:"Check network configuration"}),"\n",(0,r.jsx)(n.li,{children:"Ensure firewall rules"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Volume Mounting"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check directory permissions"}),"\n",(0,r.jsx)(n.li,{children:"Verify absolute paths"}),"\n",(0,r.jsx)(n.li,{children:"Ensure SELinux context"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resource Issues"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Monitor container resources"}),"\n",(0,r.jsx)(n.li,{children:"Adjust resource limits"}),"\n",(0,r.jsx)(n.li,{children:"Check for memory leaks"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Configure ",(0,r.jsx)(n.a,{href:"github-webhooks",children:"GitHub Webhooks"})]}),"\n",(0,r.jsxs)(n.li,{children:["Set up ",(0,r.jsx)(n.a,{href:"ci-cd/overview",children:"CI/CD Integration"})]}),"\n",(0,r.jsxs)(n.li,{children:["Implement ",(0,r.jsx)(n.a,{href:"telemetry",children:"Telemetry"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>c});var s=i(6540);const r={},l=s.createContext(r);function o(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);