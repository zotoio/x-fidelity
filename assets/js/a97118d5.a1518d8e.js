"use strict";(self.webpackChunkx_fidelity_website=self.webpackChunkx_fidelity_website||[]).push([[9023],{8222:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"facts","title":"Facts","description":"Facts are data providers in x-fidelity that collect and provide information about your codebase for rule evaluation.","source":"@site/docs/facts.md","sourceDirName":".","slug":"/facts","permalink":"/x-fidelity/docs/facts","draft":false,"unlisted":false,"editUrl":"https://github.com/zotoio/x-fidelity/edit/main/website/docs/facts.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"docs","previous":{"title":"Operators","permalink":"/x-fidelity/docs/operators"},"next":{"title":"Exemptions","permalink":"/x-fidelity/docs/exemptions"}}');var l=i(4848),r=i(8453);const t={sidebar_position:7},a="Facts",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Built-in Facts",id:"built-in-facts",level:2},{value:"<code>repoFilesystemFacts</code>",id:"repofilesystemfacts",level:3},{value:"<code>repoDependencyFacts</code>",id:"repodependencyfacts",level:3},{value:"<code>openaiAnalysisFacts</code>",id:"openaianalysisfacts",level:3},{value:"<code>globalFileAnalysisFacts</code>",id:"globalfileanalysisfacts",level:3},{value:"<code>remoteSubstringValidation</code>",id:"remotesubstringvalidation",level:3},{value:"<code>missingRequiredFiles</code>",id:"missingrequiredfiles",level:3},{value:"AST-Based Facts",id:"ast-based-facts",level:3},{value:"<code>functionComplexity</code>",id:"functioncomplexity",level:4},{value:"<code>functionCount</code>",id:"functioncount",level:4},{value:"<code>codeRhythm</code>",id:"coderhythm",level:4},{value:"Creating Custom Facts",id:"creating-custom-facts",level:2},{value:"Performance Tracking",id:"performance-tracking",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Next Steps",id:"next-steps",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"facts",children:"Facts"})}),"\n",(0,l.jsx)(n.p,{children:"Facts are data providers in x-fidelity that collect and provide information about your codebase for rule evaluation."}),"\n",(0,l.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsx)(n.p,{children:"Facts are functions that:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Gather data about your codebase"}),"\n",(0,l.jsx)(n.li,{children:"Feed information into rule conditions"}),"\n",(0,l.jsx)(n.li,{children:"Can be synchronous or asynchronous"}),"\n",(0,l.jsx)(n.li,{children:"Support custom implementations via plugins"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"built-in-facts",children:"Built-in Facts"}),"\n",(0,l.jsx)(n.h3,{id:"repofilesystemfacts",children:(0,l.jsx)(n.code,{children:"repoFilesystemFacts"})}),"\n",(0,l.jsx)(n.p,{children:"Provides information about files in the repository."}),"\n",(0,l.jsx)(n.p,{children:"Features:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Recursive directory traversal"}),"\n",(0,l.jsx)(n.li,{children:"File content reading"}),"\n",(0,l.jsx)(n.li,{children:"Path filtering"}),"\n",(0,l.jsx)(n.li,{children:"Symlink handling"}),"\n",(0,l.jsx)(n.li,{children:"Security checks"}),"\n",(0,l.jsx)(n.li,{children:"Path traversal protection"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example usage in a rule:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n    "fact": "fileData",\n    "path": "$.fileContent",\n    "operator": "fileContains",\n    "value": "TODO"\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"repodependencyfacts",children:(0,l.jsx)(n.code,{children:"repoDependencyFacts"})}),"\n",(0,l.jsx)(n.p,{children:"Analyzes project dependencies."}),"\n",(0,l.jsx)(n.p,{children:"Features:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Support for npm and Yarn"}),"\n",(0,l.jsx)(n.li,{children:"Version comparison"}),"\n",(0,l.jsx)(n.li,{children:"Nested dependency analysis"}),"\n",(0,l.jsx)(n.li,{children:"Pre-release version handling"}),"\n",(0,l.jsx)(n.li,{children:"Circular dependency detection"}),"\n",(0,l.jsx)(n.li,{children:"Namespaced package support"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example usage in a rule:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n    "fact": "repoDependencyAnalysis",\n    "params": {\n        "resultFact": "dependencyResults",\n        "minimumDependencyVersions": {\n            "react": ">=17.0.0",\n            "typescript": "^4.0.0"\n        }\n    },\n    "operator": "outdatedFramework",\n    "value": true\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"openaianalysisfacts",children:(0,l.jsx)(n.code,{children:"openaiAnalysisFacts"})}),"\n",(0,l.jsx)(n.p,{children:"Provides AI-powered code analysis (requires OpenAI integration)."}),"\n",(0,l.jsx)(n.p,{children:"Features:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Custom prompts"}),"\n",(0,l.jsx)(n.li,{children:"Severity scoring"}),"\n",(0,l.jsx)(n.li,{children:"Code suggestions"}),"\n",(0,l.jsx)(n.li,{children:"Security analysis"}),"\n",(0,l.jsx)(n.li,{children:"Response format validation"}),"\n",(0,l.jsx)(n.li,{children:"JSON schema validation"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example usage in a rule:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n    "fact": "openaiAnalysis",\n    "params": {\n        "prompt": "Identify security issues",\n        "resultFact": "securityAnalysis"\n    },\n    "operator": "openaiAnalysisHighSeverity",\n    "value": 8\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"globalfileanalysisfacts",children:(0,l.jsx)(n.code,{children:"globalFileAnalysisFacts"})}),"\n",(0,l.jsx)(n.p,{children:"Analyzes patterns across multiple files to track API migrations and library upgrades."}),"\n",(0,l.jsx)(n.p,{children:"Features:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Separate tracking of new and legacy patterns"}),"\n",(0,l.jsx)(n.li,{children:"File filtering by extension or path"}),"\n",(0,l.jsx)(n.li,{children:"Detailed match information"}),"\n",(0,l.jsx)(n.li,{children:"Statistical analysis of adoption rates"}),"\n",(0,l.jsx)(n.li,{children:"Multiple output grouping options (file or pattern-centric)"}),"\n",(0,l.jsx)(n.li,{children:"Line number and context tracking"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example usage in a rule:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n    "fact": "globalFileAnalysis",\n    "params": {\n        "newPatterns": ["newApiMethod\\\\(", "modernApiCall\\\\("],\n        "legacyPatterns": ["legacyApiMethod\\\\(", "deprecatedApiCall\\\\("],\n        "fileFilter": "\\\\.(ts|js)$",\n        "outputGrouping": "pattern",\n        "resultFact": "apiMigrationAnalysis"\n    },\n    "operator": "globalPatternRatio",\n    "value": 0.8\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"remotesubstringvalidation",children:(0,l.jsx)(n.code,{children:"remoteSubstringValidation"})}),"\n",(0,l.jsx)(n.p,{children:"Validates extracted strings against remote endpoints."}),"\n",(0,l.jsx)(n.p,{children:"Features:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Pattern extraction"}),"\n",(0,l.jsx)(n.li,{children:"Remote API validation"}),"\n",(0,l.jsx)(n.li,{children:"Flexible HTTP methods"}),"\n",(0,l.jsx)(n.li,{children:"Response parsing"}),"\n",(0,l.jsx)(n.li,{children:"JSONPath validation"}),"\n",(0,l.jsx)(n.li,{children:"Custom headers and body"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example usage in a rule:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n    "fact": "remoteSubstringValidation",\n    "params": {\n        "pattern": "\\"systemId\\":[\\\\s]*\\"([a-z]*)\\"",\n        "flags": "gi",\n        "validationParams": {\n            "url": "http://validator.example.com/check",\n            "method": "POST",\n            "headers": {\n                "Content-Type": "application/json"\n            },\n            "body": {\n                "systemId": "#MATCH#"\n            },\n            "checkJsonPath": "$.validSystems[?(@.id == \'#MATCH#\')]"\n        },\n        "resultFact": "validationResult"\n    },\n    "operator": "invalidRemoteValidation",\n    "value": true\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"missingrequiredfiles",children:(0,l.jsx)(n.code,{children:"missingRequiredFiles"})}),"\n",(0,l.jsx)(n.p,{children:"Checks for required files in the repository."}),"\n",(0,l.jsx)(n.p,{children:"Features:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Path pattern matching"}),"\n",(0,l.jsx)(n.li,{children:"Detailed reporting"}),"\n",(0,l.jsx)(n.li,{children:"Support for glob patterns"}),"\n",(0,l.jsx)(n.li,{children:"Path normalization"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example usage in a rule:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n    "fact": "missingRequiredFiles",\n    "params": {\n        "requiredFiles": [\n            "/README.md",\n            "/CONTRIBUTING.md",\n            "/LICENSE"\n        ],\n        "resultFact": "missingRequiredFilesResult"\n    },\n    "operator": "missingRequiredFiles",\n    "value": true\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"ast-based-facts",children:"AST-Based Facts"}),"\n",(0,l.jsx)(n.p,{children:"Several facts are available for analyzing code structure:"}),"\n",(0,l.jsx)(n.h4,{id:"functioncomplexity",children:(0,l.jsx)(n.code,{children:"functionComplexity"})}),"\n",(0,l.jsx)(n.p,{children:"Analyzes function complexity metrics."}),"\n",(0,l.jsx)(n.p,{children:"Features:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Cyclomatic complexity"}),"\n",(0,l.jsx)(n.li,{children:"Cognitive complexity"}),"\n",(0,l.jsx)(n.li,{children:"Nesting depth"}),"\n",(0,l.jsx)(n.li,{children:"Parameter count"}),"\n",(0,l.jsx)(n.li,{children:"Return count"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example usage:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n    "fact": "functionComplexity",\n    "params": {\n        "resultFact": "complexityResult",\n        "thresholds": {\n            "cyclomaticComplexity": 20,\n            "cognitiveComplexity": 30,\n            "nestingDepth": 10,\n            "parameterCount": 5,\n            "returnCount": 10\n        }\n    },\n    "operator": "astComplexity",\n    "value": {\n        "cyclomaticComplexity": 20,\n        "cognitiveComplexity": 30,\n        "nestingDepth": 10,\n        "parameterCount": 5,\n        "returnCount": 10\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h4,{id:"functioncount",children:(0,l.jsx)(n.code,{children:"functionCount"})}),"\n",(0,l.jsx)(n.p,{children:"Counts functions in a file."}),"\n",(0,l.jsx)(n.p,{children:"Features:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Function type detection"}),"\n",(0,l.jsx)(n.li,{children:"Named and anonymous functions"}),"\n",(0,l.jsx)(n.li,{children:"Arrow functions"}),"\n",(0,l.jsx)(n.li,{children:"Method definitions"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"coderhythm",children:(0,l.jsx)(n.code,{children:"codeRhythm"})}),"\n",(0,l.jsx)(n.p,{children:"Analyzes code structure and flow."}),"\n",(0,l.jsx)(n.p,{children:"Features:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Consistency measurement"}),"\n",(0,l.jsx)(n.li,{children:"Complexity analysis"}),"\n",(0,l.jsx)(n.li,{children:"Readability scoring"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"creating-custom-facts",children:"Creating Custom Facts"}),"\n",(0,l.jsxs)(n.p,{children:["You can create custom facts by implementing the ",(0,l.jsx)(n.code,{children:"FactDefn"})," interface:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"interface FactDefn {\n    name: string;\n    fn: (params: any, almanac: any) => Promise<any>;\n    priority?: number;\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"Example implementation:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:"const customFact = {\n    name: 'myCustomFact',\n    fn: async (params, almanac) => {\n        // Your fact logic here\n        return { result: 'custom data' };\n    },\n    priority: 1\n};\n"})}),"\n",(0,l.jsx)(n.h2,{id:"performance-tracking",children:"Performance Tracking"}),"\n",(0,l.jsx)(n.p,{children:"Facts are automatically tracked for performance metrics:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Execution count"}),"\n",(0,l.jsx)(n.li,{children:"Total execution time"}),"\n",(0,l.jsx)(n.li,{children:"Average execution time"}),"\n",(0,l.jsx)(n.li,{children:"Longest execution time"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"These metrics are included in the analysis results and can help identify performance bottlenecks."}),"\n",(0,l.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Performance"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Cache expensive operations"}),"\n",(0,l.jsx)(n.li,{children:"Use async/await for I/O"}),"\n",(0,l.jsx)(n.li,{children:"Implement proper error handling"}),"\n",(0,l.jsx)(n.li,{children:"Consider setting appropriate priorities"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Security"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Validate all inputs"}),"\n",(0,l.jsx)(n.li,{children:"Sanitize file paths"}),"\n",(0,l.jsx)(n.li,{children:"Handle sensitive data carefully"}),"\n",(0,l.jsx)(n.li,{children:"Use maskSensitiveData for logging"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Maintainability"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Document your facts"}),"\n",(0,l.jsx)(n.li,{children:"Include unit tests"}),"\n",(0,l.jsx)(n.li,{children:"Follow naming conventions"}),"\n",(0,l.jsx)(n.li,{children:"Use consistent result formats"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Integration"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Always add results to almanac with addRuntimeFact"}),"\n",(0,l.jsx)(n.li,{children:"Handle dependencies properly"}),"\n",(0,l.jsx)(n.li,{children:"Consider fact priorities"}),"\n",(0,l.jsx)(n.li,{children:"Provide detailed error information"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Learn about ",(0,l.jsx)(n.a,{href:"operators",children:"Operators"})]}),"\n",(0,l.jsxs)(n.li,{children:["Explore ",(0,l.jsx)(n.a,{href:"rules",children:"Rules"})]}),"\n",(0,l.jsxs)(n.li,{children:["Create ",(0,l.jsx)(n.a,{href:"plugins/overview",children:"Custom Plugins"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>a});var s=i(6540);const l={},r=s.createContext(l);function t(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);