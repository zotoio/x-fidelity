"use strict";(self.webpackChunkx_fidelity_website=self.webpackChunkx_fidelity_website||[]).push([[4482],{187:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"packages/core","title":"x-fidelity-core","description":"The core analysis engine and utilities that power all X-Fidelity functionality.","source":"@site/docs/packages/core.md","sourceDirName":"packages","slug":"/packages/core","permalink":"/x-fidelity/docs/packages/core","draft":false,"unlisted":false,"editUrl":"https://github.com/zotoio/x-fidelity/edit/main/website/docs/packages/core.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"VSCode Extension Development","permalink":"/x-fidelity/docs/vscode-extension/development"},"next":{"title":"Archetypes","permalink":"/x-fidelity/docs/archetypes"}}');var r=i(4848),l=i(8453);const t={},c="x-fidelity-core",o={},a=[{value:"Overview",id:"overview",level:2},{value:"Key Components",id:"key-components",level:2},{value:"Analysis Engine",id:"analysis-engine",level:3},{value:"Configuration Management",id:"configuration-management",level:3},{value:"Plugin System",id:"plugin-system",level:3},{value:"Utilities and Infrastructure",id:"utilities-and-infrastructure",level:3},{value:"Notification System",id:"notification-system",level:3},{value:"Architecture",id:"architecture",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Rule Engine Integration",id:"rule-engine-integration",level:3},{value:"Performance Optimization",id:"performance-optimization",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"Usage",id:"usage",level:2},{value:"Direct Usage (Advanced)",id:"direct-usage-advanced",level:3},{value:"Plugin Development",id:"plugin-development",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Performance Tuning",id:"performance-tuning",level:3},{value:"Dependencies",id:"dependencies",level:2},{value:"Core Dependencies",id:"core-dependencies",level:3},{value:"Analysis Dependencies",id:"analysis-dependencies",level:3},{value:"Integration Dependencies",id:"integration-dependencies",level:3},{value:"Testing",id:"testing",level:2},{value:"Development",id:"development",level:2},{value:"Building",id:"building",level:3},{value:"Debugging",id:"debugging",level:3},{value:"Related Packages",id:"related-packages",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"x-fidelity-core",children:"x-fidelity-core"})}),"\n",(0,r.jsx)(n.p,{children:"The core analysis engine and utilities that power all X-Fidelity functionality."}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"x-fidelity-core"})," (",(0,r.jsx)(n.code,{children:"@x-fidelity/core"}),") is the heart of the X-Fidelity framework, providing the fundamental analysis engine, configuration management, and utility functions that all other packages depend on."]}),"\n",(0,r.jsx)(n.h2,{id:"key-components",children:"Key Components"}),"\n",(0,r.jsx)(n.h3,{id:"analysis-engine",children:"Analysis Engine"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"analyzeCodebase"})," (",(0,r.jsx)(n.code,{children:"core/engine/analyzer.ts"}),"): Main entry function for codebase analysis"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Engine Setup/Runner"})," (",(0,r.jsx)(n.code,{children:"core/engine/"}),"): Sets up and executes the rules engine"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Facts/Operators"}),": Extensible system for data collection and rule evaluation"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"configuration-management",children:"Configuration Management"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ConfigManager"})," (",(0,r.jsx)(n.code,{children:"core/configManager.ts"}),"): Manages archetype configurations and rules"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Local Configuration"}),": Support for project-specific ",(0,r.jsx)(n.code,{children:".xfi-config.json"})," files"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Remote Configuration"}),": Integration with configuration servers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Exemption System"}),": Time-limited rule exemptions with expiration tracking"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"plugin-system",children:"Plugin System"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Plugin Registry"})," (",(0,r.jsx)(n.code,{children:"core/pluginRegistry.ts"}),"): Dynamically loads and manages plugins"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Dynamic Loading"}),": Support for both built-in and external plugins"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Extensible Architecture"}),": Plugin-based facts and operators"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"utilities-and-infrastructure",children:"Utilities and Infrastructure"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Logging System"}),": Mode-aware ",(0,r.jsx)(n.code,{children:"LoggerProvider"})," with Pino-based CLI logger"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance Monitoring"})," (",(0,r.jsx)(n.code,{children:"utils/performanceMonitor.ts"}),"): Built-in performance tracking"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Telemetry"})," (",(0,r.jsx)(n.code,{children:"utils/telemetry.ts"}),"): Usage analytics and performance metrics"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"OpenAI Integration"})," (",(0,r.jsx)(n.code,{children:"utils/openai.ts"}),"): AI-powered code analysis capabilities"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"notification-system",children:"Notification System"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Email Notifications"})," (",(0,r.jsx)(n.code,{children:"notifications/emailNotificationProvider.ts"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Slack Integration"})," (",(0,r.jsx)(n.code,{children:"notifications/slackNotificationProvider.ts"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Microsoft Teams"})," (",(0,r.jsx)(n.code,{children:"notifications/teamsNotificationProvider.ts"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Code Owners Integration"})," (",(0,r.jsx)(n.code,{children:"notifications/codeOwnersProvider.ts"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,r.jsx)(n.p,{children:"The core package follows a modular architecture:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"core/\n\u251c\u2500\u2500 engine/           # Analysis engine and execution\n\u251c\u2500\u2500 configManager.ts  # Configuration management\n\u251c\u2500\u2500 pluginRegistry.ts # Plugin system\n\u2514\u2500\u2500 index.ts         # Public API exports\n\nutils/\n\u251c\u2500\u2500 logger.ts        # Logging infrastructure\n\u251c\u2500\u2500 telemetry.ts     # Analytics and metrics\n\u251c\u2500\u2500 openai.ts        # AI integration\n\u2514\u2500\u2500 performanceMonitor.ts\n\nnotifications/\n\u251c\u2500\u2500 emailNotificationProvider.ts\n\u251c\u2500\u2500 slackNotificationProvider.ts\n\u251c\u2500\u2500 teamsNotificationProvider.ts\n\u2514\u2500\u2500 codeOwnersProvider.ts\n"})}),"\n",(0,r.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,r.jsx)(n.h3,{id:"rule-engine-integration",children:"Rule Engine Integration"}),"\n",(0,r.jsxs)(n.p,{children:["Built on ",(0,r.jsx)(n.a,{href:"https://github.com/CacheControl/json-rules-engine",children:"json-rules-engine"}),", providing:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Flexible condition evaluation"}),"\n",(0,r.jsx)(n.li,{children:"Custom fact collection"}),"\n",(0,r.jsx)(n.li,{children:"Extensible operator system"}),"\n",(0,r.jsx)(n.li,{children:"Event-driven rule triggering"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Caching"}),": Intelligent caching of analysis results"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Incremental Analysis"}),": Support for analyzing only changed files"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Memory Management"}),": Efficient memory usage patterns"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Async Processing"}),": Non-blocking analysis execution"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Graceful Degradation"}),": Continues analysis even when some components fail"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Comprehensive Logging"}),": Detailed error reporting and stack traces"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Recovery Mechanisms"}),": Automatic recovery from transient failures"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(n.h3,{id:"direct-usage-advanced",children:"Direct Usage (Advanced)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { analyzeCodebase } from '@x-fidelity/core';\n\nconst results = await analyzeCodebase({\n  repoPath: './src',\n  archetype: 'node-fullstack',\n  configServer: 'https://config.example.com'\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"plugin-development",children:"Plugin Development"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import { XFiPlugin } from '@x-fidelity/types';\n\nconst myPlugin: XFiPlugin = {\n  name: 'my-custom-plugin',\n  version: '1.0.0',\n  facts: [{\n    name: 'myFact',\n    fn: async () => ({ result: 'data' })\n  }],\n  operators: [{\n    name: 'myOperator',\n    fn: (factValue, expectedValue) => factValue === expectedValue\n  }]\n};\n"})}),"\n",(0,r.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.h3,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"XFI_LOG_LEVEL"}),": Set logging level (trace, debug, info, warn, error, fatal)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"XFI_LOG_COLORS"}),": Set to 'false' to disable colored CLI output"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OPENAI_API_KEY"}),": OpenAI API key for AI-powered analysis"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OPENAI_MODEL"}),": OpenAI model to use (default: 'gpt-4o')"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"performance-tuning",children:"Performance Tuning"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Analysis Timeout"}),": Configure maximum analysis duration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Memory Limits"}),": Set memory usage boundaries"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cache TTL"}),": Control cache expiration times"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Concurrency"}),": Adjust parallel processing limits"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsx)(n.h3,{id:"core-dependencies",children:"Core Dependencies"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"json-rules-engine"}),": Rule evaluation engine"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"winston"}),": Logging framework"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"fs-extra"}),": Enhanced file system operations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"semver"}),": Semantic version parsing and comparison"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"analysis-dependencies",children:"Analysis Dependencies"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"@babel/parser"}),": JavaScript/TypeScript parsing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"esprima"}),": ECMAScript parsing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"tree-sitter"}),": Advanced syntax tree parsing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jsonpath"}),": JSON path expressions"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"integration-dependencies",children:"Integration Dependencies"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"axios"}),": HTTP client for remote configurations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"nodemailer"}),": Email notification support"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"@slack/web-api"}),": Slack integration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"openai"}),": OpenAI API client"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,r.jsx)(n.p,{children:"The core package includes comprehensive test coverage:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Run core package tests\nyarn workspace @x-fidelity/core test\n\n# Run with coverage\nyarn workspace @x-fidelity/core test:coverage\n\n# Run specific test suites\nyarn workspace @x-fidelity/core test:unit\nyarn workspace @x-fidelity/core test:integration\n"})}),"\n",(0,r.jsx)(n.h2,{id:"development",children:"Development"}),"\n",(0,r.jsx)(n.h3,{id:"building",children:"Building"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Build core package\nyarn workspace @x-fidelity/core build\n\n# Build with watch mode\nyarn workspace @x-fidelity/core build:watch\n"})}),"\n",(0,r.jsx)(n.h3,{id:"debugging",children:"Debugging"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Enable debug logging: ",(0,r.jsx)(n.code,{children:"XFI_LOG_LEVEL=debug"})]}),"\n",(0,r.jsx)(n.li,{children:"Use performance monitoring to identify bottlenecks"}),"\n",(0,r.jsx)(n.li,{children:"Leverage telemetry data for optimization insights"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-packages",children:"Related Packages"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/x-fidelity/docs/getting-started#command-line-interface",children:"x-fidelity-cli"})}),": Command-line interface that uses the core engine"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/x-fidelity/docs/vscode-extension/overview",children:"x-fidelity-vscode"})}),": VSCode extension built on core"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/x-fidelity/docs/plugins/overview",children:"x-fidelity-plugins"})}),": Plugin implementations that extend core"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/x-fidelity/docs/config-server",children:"x-fidelity-server"})}),": Configuration server using core utilities"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>c});var s=i(6540);const r={},l=s.createContext(r);function t(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);