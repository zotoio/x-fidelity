"use strict";(self.webpackChunkx_fidelity_website=self.webpackChunkx_fidelity_website||[]).push([[4901],{3477:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"rules/rule-builder-guide","title":"Rule Builder GUI","description":"The X-Fidelity Rule Builder is an interactive web-based tool for creating and editing analysis rules without writing JSON by hand. It provides a visual interface that makes rule creation more intuitive and less error-prone.","source":"@site/docs/rules/rule-builder-guide.md","sourceDirName":"rules","slug":"/rules/rule-builder-guide","permalink":"/x-fidelity/docs/rules/rule-builder-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/zotoio/x-fidelity/edit/main/website/docs/rules/rule-builder-guide.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docs","previous":{"title":"Rules Cookbook","permalink":"/x-fidelity/docs/rules/rules-cookbook"},"next":{"title":"Creating Rule Builder Templates","permalink":"/x-fidelity/docs/rules/rule-builder-templates"}}');var l=n(4848),t=n(8453);const s={sidebar_position:3},d="Rule Builder GUI",o={},c=[{value:"Launch the Rule Builder",id:"launch-the-rule-builder",level:2},{value:"Features",id:"features",level:2},{value:"Visual Tree Editor",id:"visual-tree-editor",level:3},{value:"Form-Based Editing",id:"form-based-editing",level:3},{value:"Live JSON Preview",id:"live-json-preview",level:3},{value:"Template Library",id:"template-library",level:3},{value:"Rule Simulation",id:"rule-simulation",level:3},{value:"Getting Started",id:"getting-started",level:2},{value:"1. Start with a Template",id:"1-start-with-a-template",level:3},{value:"2. Customize Your Rule",id:"2-customize-your-rule",level:3},{value:"3. Test with Simulation",id:"3-test-with-simulation",level:3},{value:"4. Export Your Rule",id:"4-export-your-rule",level:3},{value:"Keyboard Shortcuts",id:"keyboard-shortcuts",level:2},{value:"Theme Support",id:"theme-support",level:2},{value:"Tips and Best Practices",id:"tips-and-best-practices",level:2},{value:"Naming Conventions",id:"naming-conventions",level:3},{value:"Condition Structure",id:"condition-structure",level:3},{value:"Common Patterns",id:"common-patterns",level:3},{value:"Check for a Pattern in Code",id:"check-for-a-pattern-in-code",level:4},{value:"Validate Dependency Version",id:"validate-dependency-version",level:4},{value:"Check AST Complexity",id:"check-ast-complexity",level:4},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.header,{children:(0,l.jsx)(i.h1,{id:"rule-builder-gui",children:"Rule Builder GUI"})}),"\n",(0,l.jsx)(i.p,{children:"The X-Fidelity Rule Builder is an interactive web-based tool for creating and editing analysis rules without writing JSON by hand. It provides a visual interface that makes rule creation more intuitive and less error-prone."}),"\n",(0,l.jsx)(i.h2,{id:"launch-the-rule-builder",children:"Launch the Rule Builder"}),"\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:(0,l.jsx)(i.a,{href:"https://zotoio.github.io/x-fidelity/rule-builder/",children:"Open Rule Builder"})})}),"\n",(0,l.jsx)(i.h2,{id:"features",children:"Features"}),"\n",(0,l.jsx)(i.h3,{id:"visual-tree-editor",children:"Visual Tree Editor"}),"\n",(0,l.jsx)(i.p,{children:"Navigate your rule structure using an intuitive tree view. Click on any node (conditions, events, operators) to select and edit it. The tree provides a clear hierarchical view of your rule's structure."}),"\n",(0,l.jsx)(i.h3,{id:"form-based-editing",children:"Form-Based Editing"}),"\n",(0,l.jsx)(i.p,{children:"Edit selected nodes using a form interface with proper field validation. The form adapts to the type of node you're editing:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Conditions"}),": Configure facts, operators, and values"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Events"}),": Set event types and message parameters"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Rule metadata"}),": Edit name, description, and plugins"]}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"live-json-preview",children:"Live JSON Preview"}),"\n",(0,l.jsx)(i.p,{children:"The right panel shows a live JSON preview that updates as you make changes. The JSON view is:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Synchronized"}),": Changes in the form immediately update the JSON"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Bidirectional"}),": You can also edit the JSON directly"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Validated"}),": Schema validation highlights any errors"]}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"template-library",children:"Template Library"}),"\n",(0,l.jsx)(i.p,{children:"Start from pre-built templates for common rule patterns:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Dependency version checks"}),"\n",(0,l.jsx)(i.li,{children:"Code pattern detection"}),"\n",(0,l.jsx)(i.li,{children:"File structure validation"}),"\n",(0,l.jsx)(i.li,{children:"Security checks"}),"\n"]}),"\n",(0,l.jsxs)(i.p,{children:["Click the ",(0,l.jsx)(i.strong,{children:"Templates"})," button in the header to browse available templates."]}),"\n",(0,l.jsx)(i.h3,{id:"rule-simulation",children:"Rule Simulation"}),"\n",(0,l.jsx)(i.p,{children:"Test your rules against sample code before deploying them. The simulation panel at the bottom allows you to:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Load fixture files from the demo configuration"}),"\n",(0,l.jsx)(i.li,{children:"Run your rule against the loaded fixtures"}),"\n",(0,l.jsx)(i.li,{children:"View detailed results showing which conditions matched"}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,l.jsx)(i.h3,{id:"1-start-with-a-template",children:"1. Start with a Template"}),"\n",(0,l.jsxs)(i.ol,{children:["\n",(0,l.jsxs)(i.li,{children:["Click the ",(0,l.jsx)(i.strong,{children:"Templates"})," button in the header"]}),"\n",(0,l.jsx)(i.li,{children:"Browse categories: Security, Dependencies, Patterns, etc."}),"\n",(0,l.jsx)(i.li,{children:"Click a template to load it"}),"\n",(0,l.jsx)(i.li,{children:"The rule will appear in the editor ready for customization"}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"2-customize-your-rule",children:"2. Customize Your Rule"}),"\n",(0,l.jsx)(i.p,{children:"Use the form editor to modify the rule:"}),"\n",(0,l.jsxs)(i.ol,{children:["\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsxs)(i.p,{children:[(0,l.jsx)(i.strong,{children:"Edit rule metadata"})," (top of form)"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:["Name: Unique identifier with ",(0,l.jsx)(i.code,{children:"-global"})," or ",(0,l.jsx)(i.code,{children:"-iterative"})," suffix"]}),"\n",(0,l.jsx)(i.li,{children:"Description: Human-readable explanation"}),"\n",(0,l.jsx)(i.li,{children:"Plugins: Required plugins for facts/operators used"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsxs)(i.p,{children:[(0,l.jsx)(i.strong,{children:"Modify conditions"})," (click in tree to select)"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Fact: The data source to evaluate"}),"\n",(0,l.jsx)(i.li,{children:"Operator: The comparison function"}),"\n",(0,l.jsx)(i.li,{children:"Value: The expected value or pattern"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsxs)(i.p,{children:[(0,l.jsx)(i.strong,{children:"Configure event"})," (select event node in tree)"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:["Type: ",(0,l.jsx)(i.code,{children:"warning"})," or ",(0,l.jsx)(i.code,{children:"fatality"})]}),"\n",(0,l.jsx)(i.li,{children:"Message: Description shown when rule triggers"}),"\n",(0,l.jsx)(i.li,{children:"Details: Additional context data"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"3-test-with-simulation",children:"3. Test with Simulation"}),"\n",(0,l.jsxs)(i.ol,{children:["\n",(0,l.jsxs)(i.li,{children:["Expand the ",(0,l.jsx)(i.strong,{children:"Simulation Panel"})," at the bottom"]}),"\n",(0,l.jsx)(i.li,{children:"Select a fixture from the dropdown"}),"\n",(0,l.jsxs)(i.li,{children:["Click ",(0,l.jsx)(i.strong,{children:"Run Simulation"})]}),"\n",(0,l.jsx)(i.li,{children:"Review results showing matched conditions and events"}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"4-export-your-rule",children:"4. Export Your Rule"}),"\n",(0,l.jsx)(i.p,{children:"When satisfied with your rule:"}),"\n",(0,l.jsxs)(i.ol,{children:["\n",(0,l.jsxs)(i.li,{children:["Click the ",(0,l.jsx)(i.strong,{children:"Copy"})," button above the JSON preview"]}),"\n",(0,l.jsx)(i.li,{children:"The rule JSON is copied to your clipboard"}),"\n",(0,l.jsxs)(i.li,{children:["Save it to your rules directory (e.g., ",(0,l.jsx)(i.code,{children:"rules/my-rule.json"}),")"]}),"\n",(0,l.jsx)(i.li,{children:"Reference the rule in your archetype configuration"}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"keyboard-shortcuts",children:"Keyboard Shortcuts"}),"\n",(0,l.jsxs)(i.table,{children:[(0,l.jsx)(i.thead,{children:(0,l.jsxs)(i.tr,{children:[(0,l.jsx)(i.th,{children:"Shortcut"}),(0,l.jsx)(i.th,{children:"Action"})]})}),(0,l.jsxs)(i.tbody,{children:[(0,l.jsxs)(i.tr,{children:[(0,l.jsxs)(i.td,{children:[(0,l.jsx)(i.code,{children:"Ctrl+Z"})," / ",(0,l.jsx)(i.code,{children:"Cmd+Z"})]}),(0,l.jsx)(i.td,{children:"Undo"})]}),(0,l.jsxs)(i.tr,{children:[(0,l.jsxs)(i.td,{children:[(0,l.jsx)(i.code,{children:"Ctrl+Shift+Z"})," / ",(0,l.jsx)(i.code,{children:"Cmd+Shift+Z"})]}),(0,l.jsx)(i.td,{children:"Redo"})]}),(0,l.jsxs)(i.tr,{children:[(0,l.jsxs)(i.td,{children:[(0,l.jsx)(i.code,{children:"Ctrl+C"})," / ",(0,l.jsx)(i.code,{children:"Cmd+C"})]}),(0,l.jsx)(i.td,{children:"Copy selected"})]}),(0,l.jsxs)(i.tr,{children:[(0,l.jsx)(i.td,{children:(0,l.jsx)(i.code,{children:"Escape"})}),(0,l.jsx)(i.td,{children:"Deselect current node"})]})]})]}),"\n",(0,l.jsx)(i.h2,{id:"theme-support",children:"Theme Support"}),"\n",(0,l.jsx)(i.p,{children:"The Rule Builder supports both light and dark modes:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Click the sun/moon icon in the header to toggle"}),"\n",(0,l.jsx)(i.li,{children:"Theme preference syncs with your Docusaurus docs preference"}),"\n",(0,l.jsx)(i.li,{children:"Uses consistent X-Fidelity colors across both modes"}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"tips-and-best-practices",children:"Tips and Best Practices"}),"\n",(0,l.jsx)(i.h3,{id:"naming-conventions",children:"Naming Conventions"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:["Use ",(0,l.jsx)(i.strong,{children:"kebab-case"})," for rule names: ",(0,l.jsx)(i.code,{children:"detect-api-keys-iterative"})]}),"\n",(0,l.jsxs)(i.li,{children:["Always include the scope suffix:","\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"-global"})," for repository-wide checks (run once)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"-iterative"})," for per-file checks (run on each matching file)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"condition-structure",children:"Condition Structure"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:["Use ",(0,l.jsx)(i.code,{children:"all"})," for conditions that must ",(0,l.jsx)(i.strong,{children:"all"})," be true (AND logic)"]}),"\n",(0,l.jsxs)(i.li,{children:["Use ",(0,l.jsx)(i.code,{children:"any"})," for conditions where ",(0,l.jsx)(i.strong,{children:"at least one"})," must be true (OR logic)"]}),"\n",(0,l.jsx)(i.li,{children:"Nest condition groups for complex logic"}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,l.jsx)(i.h4,{id:"check-for-a-pattern-in-code",children:"Check for a Pattern in Code"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-json",children:'{\n  "fact": "globalFileAnalysis",\n  "operator": "regexMatchWithPosition",\n  "value": {\n    "pattern": "console\\\\.log\\\\(",\n    "flags": "g",\n    "resultFact": "consoleLogMatches"\n  }\n}\n'})}),"\n",(0,l.jsx)(i.h4,{id:"validate-dependency-version",children:"Validate Dependency Version"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-json",children:'{\n  "fact": "repoDependencyFacts",\n  "operator": "outdatedFramework",\n  "value": {\n    "package": "react",\n    "minVersion": "18.0.0"\n  }\n}\n'})}),"\n",(0,l.jsx)(i.h4,{id:"check-ast-complexity",children:"Check AST Complexity"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-json",children:'{\n  "fact": "functionComplexity",\n  "operator": "astComplexity",\n  "value": {\n    "threshold": 10\n  }\n}\n'})}),"\n",(0,l.jsx)(i.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:["Learn about all available ",(0,l.jsx)(i.a,{href:"/docs/operators",children:"Operators"})]}),"\n",(0,l.jsxs)(i.li,{children:["Explore ",(0,l.jsx)(i.a,{href:"/docs/facts",children:"Facts"})," for data collection"]}),"\n",(0,l.jsxs)(i.li,{children:["Read the ",(0,l.jsx)(i.a,{href:"./rules-cookbook",children:"Rules Cookbook"})," for more examples"]}),"\n",(0,l.jsxs)(i.li,{children:["Create your first rule with ",(0,l.jsx)(i.a,{href:"./hello-rule",children:"Hello Rule"})]}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,l.jsx)(i,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>s,x:()=>d});var r=n(6540);const l={},t=r.createContext(l);function s(e){const i=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),r.createElement(t.Provider,{value:i},e.children)}}}]);