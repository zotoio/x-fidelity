{
    "name": "openaiAnalysisRule",
    "conditions": {
        "all": [
            {
                "fact": "openaiAnalysisFacts",
                "params": {
                    "prompt": "Review the following code and determine if there are any critical security issues, and report each in json form in an array of objects: ",
                    "facts": {
                        "fact": "fileData",
                        "path": "$.fileContent"
                    }
                },
                "operator": "equal",
                "value": "pass"
            }
        ]
    },
    "event": {
        "type": "violation",
        "params": {
            "message": "OpenAI analysis failed for the provided facts.",
            "details": {
                "fact": "fileData",
                "path": "$.filePath"
            }
        }
    }
}
