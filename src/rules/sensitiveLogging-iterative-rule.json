{
    "name": "sensitiveLogging-iterative",
    "conditions": {
        "any": [
            {
                "fact": "fileData",
                "path": "$.fileContent",
                "operator": "fileContains",
                "value": "(?i)(api[_-]?key|auth[_-]?token|access[_-]?token|secret[_-]?key)"
            },
            {
                "fact": "fileData",
                "path": "$.fileContent",
                "operator": "fileContains",
                "value": "(?i)(password|passphrase)"
            },
            {
                "fact": "fileData",
                "path": "$.fileContent",
                "operator": "fileContains",
                "value": "(?i)(aws[_-]?access[_-]?key[_-]?id|aws[_-]?secret[_-]?access[_-]?key)"
            },
            {
                "fact": "fileData",
                "path": "$.fileContent",
                "operator": "fileContains",
                "value": "(?i)(private[_-]?key|ssh[_-]?key)"
            },
            {
                "fact": "fileData",
                "path": "$.fileContent",
                "operator": "fileContains",
                "value": "(?i)(oauth[_-]?token|jwt[_-]?token)"
            },
            {
                "fact": "fileData",
                "path": "$.fileContent",
                "operator": "fileContains",
                "value": "(?i)db[_-]?password"
            }
        ]
    },
    "event": {
        "type": "violation",
        "params": {
            "level": "warning",
            "message": "Potential sensitive data detected. This must not be logged or exposed.",
            "details": {
                "level": "fatality",
                "fact": "fileData",
                "path": "$.filePath"
            }
        }
    }
}
